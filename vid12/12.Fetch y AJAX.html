<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  
  <title>Bootstrap Site</title>

  <!-- CSS only -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

</head>


<body>
  <header>
          <h1 class="text-center">Fetch y AJAX con JAVASCRIPT</h1>
  </header>

  <div class="container border">

      <p class="p-2">

      <p>  <a fetch href="https://davidwalsh.name/fetch"> fetch API</a> </p>  
      
      <p> <a href="https://developer.mozilla.org/en-US/docs/Web/API/fetch">Fetch Parameters</a>  </p>

      <p class="text-danger ">Conceptos Claves</p>  

      <a href="https://developer.mozilla.org/es/docs/Web/HTTP">HTTP></p>

      <p <a href="https://bluuweb.github.io/desarrollo-web-bluuweb/11-10-js-fetch/#fetch-api"> Metodos HTTP</a>

      <a href="https://developer.mozilla.org/es/docs/Web/HTTP/Status"> Codigos de Estado de Respuesta</a>
      <p>Respuestas informativas (100–199),</p>
      <p></p>Respuestas satisfactorias (200–299),</p>
      <p>Redirecciones (300–399),</p>
      <p>Errores de los clientes (400–499),</p>
      <p>y errores de los servidores (500–599).</p>
      <p></p>
      
      <p> <a href="https://developer.mozilla.org/es/docs/Learn/JavaScript/Objects/JSON">Json</a> </p> 


      <h3> En profundidad</h3>

      <p> <a href="https://github.com/mdn/fetch-examples/blob/master/fetch-with-init-then-request/index.html"> fetch Cargando Imagen </a>  </p>
 

      <div class="card" > 
          <p> Imagen traida con fetch() </p>
          <img src="https://via.placeholder.com/150/92c952" width="150" height="auto">
          <h3>descriptivo</h3>
          
      </div>  


</div>









<script>

// address de forms ditto :
const url = "https://pokeapi.co/api/v2/pokemon/ditto"

fetch( url )
    //.then( (res) => res ) // p ver cabecera si llega ok.
    .then(  (res) => res.json() )   // solicitud
    .then( data => console.log( data.forms[0] ) // 

    );

/*
{name: 'ditto', url: 'https://pokeapi.co/api/v2/pokemon-form/132/'}
name: "ditto"
url: "https://pokeapi.co/api/v2/pokemon-form/132/"
[[Prototype]]: Object
*/


// =======================================================================================

//document.getElementById("boton1").addEventListener("click", () => mostrar('aries.png'));

// OBJETO IMAGEN
var myImg = new Image(100, 35);
    myImg = document.querySelector("img");
//const myImg = document.querySelector("img");

// OBJETO HEADER
const myHeaders = new Headers();
myHeaders.append("Content-Type", "image/jpeg");

// OBJETO OPTIONS
const myOptions ={
  method: "GET",
  headers: myHeaders,
  mode: "cors",
  cache: "default",

}

// REQUEST
const myRequest = "https://via.placeholder.com/150/92c952";


// FETCH
fetch (myRequest, myOptions ) 

    //1RA PROMISE
    .then ( (res) => {
        if( !res.ok){
            throw new Error(`HTTP error! ${res.status}`);
        }// if
        
        return res.blob();
    })//.then
    
    // 2DA PROMISE
    .then(  (blob) => {
      myImg.src = URL.createObjectURL( blob );
      //const objURL= URL.createObjectURL(blob)
      //myImg.src = objURL;
      
      // o bien:
      //document.getElementById("foto").setAttribute( 'src', URL.createObjectURL(res) ) ;

    })

    .catch(  (err) => {

        var p = document.createElement("p");
        p.appendChild( document.createTextNode(`Error ${err.message}`))
        document.body.insertBefore(p, myImage);
    })



//<p> <a href="https://github.com/mdn/fetch-examples/blob/master/fetch-with-init-then-request/index.html"> fetch Cargando Imagen </a>  </p>
 



</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
</body>
</html>