<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bootstrap Site</title>

  <!-- CSS only -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

</head>

<body>

  <h1>Call Backs </h1>





<script>
// ========================================================================
const posts = [
    {
        userId: 1,
        id: 1,
        title:
            "1. sunt aut facere repellat provident occaecati excepturi optio reprehenderit",
        body:
            "1. quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto",
    },
    {
        userId: 1,
        id: 2,
        title: "2. qui est esse",
        body:
            "2. est rerum tempore vitae\nsequi sint nihil reprehenderit dolor beatae ea dolores neque\nfugiat blanditiis voluptate porro vel nihil molestiae ut reiciendis\nqui aperiam non debitis possimus qui neque nisi nulla",
    },
    {
        userId: 1,
        id: 3,
        title: "3. ea molestias quasi exercitationem repellat qui ipsa sit aut",
        body:
            "3. et iusto sed quo iure\nvoluptatem occaecati omnis eligendi aut ad\nvoluptatem doloribus vel accusantium quis pariatur\nmolestiae porro eius odio et labore et velit aut",
    },
];
// ========================================================================

/*

// ========================================================================
console.log('----------- Callback --------------');

const findPostById0 = (id, micallback) => {

    const post = posts.find((item) => item.id === id);        //<--- ojo  (===)
    // found()
    if (post) {
        // mandamos el null ya que no existen errores. sintaxis->(error, elemento)
        micallback(null, post); // error = null, o sea no hay error.
    } else {
        // en caso de que no exista el post, SI hay error.
        micallback("CB.Post No encontrado con id: " + id);
    }
};//


// se recibe el err como primer argumento
findPostById0(1, (err, post) => {
    if (err) {
        return console.log(err);
    }
    console.log(post);
});
// ========================================================================
*/

/*
// ========================================================================
// Promise

{
  console.log('----------- Promise --------------');


  const findPostById1 = (id) => {
      const post = posts.find((item) => item.id === id);

      // devolver la promesa
      return new Promise((resolve, reject) => {
          //resolve
          if (post) {
              resolve(post);
          } else {
              reject("Promise: No encontrado por id: " + id);
          }
      });
  };

  findPostById1(2)
      .then((post) => console.log(post))
      .catch((err) => console.log(err))
      .finally(() => console.log("find1 Promise : fin de la promesa"));

}
// =========================================================================

*/

// ========================================================================
//async await
/*
{
  console.log('--------- promesa con async/await ---------');
    
  const findPostById2 = (id) =>
      new Promise((  resolve, reject  ) => {
          setTimeout(() => {
              const post = posts.find((item) => item.id === id);
              post ? resolve(post) : reject("ASYNC 2 : No encontrado por id: " + id);
          }, 2000); //                                                      <<====   OJO
  });
  
  const buscar = async (_id) => {
  
      try {
            const post = await findPostById2(_id);
            console.log('After await 2->', post);
      } catch (err) {
            console.log("BUSCAR2:No se obtuvo respuesta... id-> " + _id );
      } finally {
        console.log('finally 2 : hola')
        
      }
      
  };//const buscar

  buscar(3);
  buscar(4);  //                                   <<======= parametro
}
// =========================================================================
*/


// ========================================================================
  console.log('--------- await Promise.all[ ] ---------');

  const findPost = (id) =>

    new Promise( (resolve, reject) => {
    setTimeout( () => {
        const post = posts.find( (item) => item.id === id);
        post ? resolve(post) : reject("ASYNC 3: No encontrado por id: " + id);
    }, 2000); //                                                           <<====   ojo

  });

  
 
  const buscar = async () => {
  
      try {
           // solo en el caso que no dependan una de la otra
            const rePosts = await Promise.all([findPost(1), findPost(2)]) ;
            //
            console.log( rePosts[0].title, 
                         rePosts[1].title );


            // /*const postUno = await findPostById(1);
            //const postDos = await findPostById(2);

            // se estÃ¡ demorando 4 segundos ??
            //console.log(postUno.title, postDos.title); * /
            
      } catch (err) {
            console.log(err);
      }

  };//const buscar

  buscar();  //    
 
 
  


  /*
  const findPost = (id) =>

    new Promise((resolve, reject) => {
        setTimeout(() => {
            const post = posts.find((item) => item.id === id);
            post ? resolve(post) : reject("No encontrado por id: " + id);
        }, 2000);
    });
*/
   /* 
    const buscar = async () => {
        try {
            // solo en el caso que no dependan una de la otra
            const rePosts = await Promise.all([findPost(1), findPost(2)]);

            // console.log(rePosts);
            console.log(rePosts[0].title, rePosts[1].title);
        } catch (error) {
            console.log(error);
        }

  }; //

buscar();

*/










// block
// =========================================================================






</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
</body>
</html>